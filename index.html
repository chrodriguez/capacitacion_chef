<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <title>Chef</title>

  <meta name="viewport" content="width=device-width"/>

  <link rel="stylesheet" href="./css/reset.css" type="text/css"/>
  <link rel="stylesheet" href="./css/showoff.css" type="text/css"/>

  <link type="text/css" href="./css/fg.menu.css" media="screen" rel="stylesheet" />
  <link type="text/css" href="./css/theme/ui.all.css" media="screen" rel="stylesheet" />
  <link type="text/css" href="./css/sh_style.css" rel="stylesheet" />

  <script type="text/javascript" src="./js/jquery-1.7.2.min.js"></script>
  <script type="text/javascript" src="./js/jquery.cycle.all.js"></script>
	<script type="text/javascript" src="./js/jquery-print.js"></script>
  <script type="text/javascript" src="./js/jquery.batchImageLoad.js"></script>

  <script type="text/javascript" src="./js/jquery.doubletap-0.1.js"></script>

  <script type="text/javascript" src="./js/fg.menu.js"></script>
  <script type="text/javascript" src="./js/showoff.js"></script>
  <script type="text/javascript" src="./js/jTypeWriter.js"> </script>
  <script type="text/javascript" src="./js/sh_main.min.js"></script>
  <script type="text/javascript" src="./js/core.js"></script>
  <script type="text/javascript" src="./js/showoffcore.js"></script>
  <script type="text/javascript" src="./js/coffee-script.js"></script>

  
    
      <script type="text/javascript" src="./js/sh_lang/sh_sh.min.js"></script>
    
      <script type="text/javascript" src="./js/sh_lang/sh_ruby.min.js"></script>
    
  

  
    <link rel="stylesheet" href="./file/base.css" type="text/css"/>
  

  

  <script type="text/javascript">
  $(function(){
      setupPreso(false, './');
  });
  </script>

</head>

<body>

<a tabindex="0" href="#search-engines" class="fg-button fg-button-icon-right ui-widget ui-state-default ui-corner-all" id="navmenu"><span class="ui-icon ui-icon-triangle-1-s"></span>slides</a>
<div id="navigation" class="hidden"></div>

<div id="help">
  <table>
    <tr><td class="key">z, ?</td><td>toggle help (this)</td></tr>
    <tr><td class="key">space, &rarr;</td><td>next slide</td></tr>
    <tr><td class="key">shift-space, &larr;</td><td>previous slide</td></tr>
    <tr><td class="key">d</td><td>toggle debug mode</td></tr>
    <tr><td class="key">## &lt;ret&gt;</td><td>go to slide #</td></tr>
    <tr><td class="key">c, t</td><td>table of contents (vi)</td></tr>
    <tr><td class="key">f</td><td>toggle footer</td></tr>
    <tr><td class="key">r</td><td>reload slides</td></tr>
    <tr><td class="key">n</td><td>toggle notes</td></tr>
    <tr><td class="key">p</td><td>run preshow</td></tr>
    <tr><td class="key">P</td><td>toggle pause</td></tr>
  </table>
</div>

<div class="buttonNav">
  <input type="submit" onClick="prevStep();" value="prev"/>
  <input type="submit" onClick="nextStep();" value="next"/>
</div>

<div id="preso">loading presentation...</div>
<div id="footer">
  <span id="slideInfo"></span>
  <span id="debugInfo"></span>
  <span id="notesInfo"></span>
</div>

<div id="slides" class="offscreen" style="display:none;">
<div class="slide" data-transition="none">
  <div class="content subsection center" ref="00-intro/01_index/1">
<p><img src="./file/00-intro/cocinando.png" alt="cocinando"/>

<h1>Opscode Chef</h1>

<div class="destacado"> Un curso de cocina para Administradores, Desarrolladores y DBAs </div>

<p><img src="./file/00-intro/logo.png" alt="logo">
<div class="destacado">
por Lic. Christian A. Rodriguez <a href="https://twitter.com/car_unlp">@car_unlp</a>
</div></img>
</p>
</p>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content smbullets incremental" ref="00-intro/01_index/2">
<h1>Temas</h1>

<ul>
<li>Introducci&#xF3;n</li>
<li>Chef</li>
<li>Chef en producci&#xF3;n</li>
</ul>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content subsection center" ref="00-intro/01_index/3">
<h1>Introducci&#xF3;n</h1>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content smbullets incremental" ref="00-intro/01_index/4">
<h1>Introducci&#xF3;n</h1>

<ul>
<li>Los problemas</li>
<li>La b&#xFA;squeda de soluciones</li>
<li>DevOps</li>
<li>Productos que simplifican las tareas</li>
</ul>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content subsection center" ref="00-intro/02_problemas/1">
<h1>Los Problemas</h1>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content bullets" ref="00-intro/02_problemas/2">
<h1>Los problemas</h1>

<ul>
<li>Los problemas pueden verse desde:

<ul>
<li>La perspectiva de desarrollo</li>
<li>La perspectiva de soporte</li>
<li>La perspectiva de producci&#xF3;n</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content smbullets" ref="00-intro/02_problemas/3">
<h1>Los problemas desde la visi&#xF3;n de desarrollo</h1>

<ul>
<li>Tenemos 94 proyectos, 58 est&#xE1;n con actividad</li>
<li>Versiones de productos todas las semanas</li>
<li>Por d&#xED;a se hacen alrededor de 5 deploys: 

<ul>
<li><em>Por errores en producci&#xF3;n</em></li>
<li><em>Por nuevas funcionalidades solicitadas</em></li>
</ul></li>
<li>Ambientes de trabajo:

<ul>
<li>Desarrollo</li>
<li>Pruebas</li>
<li><em>Preproducci&#xF3;n</em></li>
<li>Producci&#xF3;n</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="scrollVert">
  <div class="content smbullets" ref="00-intro/02_problemas/4">
<h1>M&#xE1;s problemas desde la visi&#xF3;n de desarrollo</h1>

<ul>
<li>Ambientes complejos:

<ul>
<li><strong>SSO</strong> </li>
<li><strong>API</strong> </li>
<li><strong>Balanceo y cache</strong> </li>
</ul></li>
<li>Ejemplo con gr&#xE1;ficos:
<div class="small_images">
<img src="./file/00-intro/topologia-fisica.png" alt="Disposici&#xF3;n f&#xED;sica">
<img src="./file/00-intro/topologia-logica.png" alt="Disposici&#xF3;n l&#xF3;gica">
</img></img>
</div>
</li>
</ul>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content smbullets" ref="00-intro/02_problemas/5">
<h1>M&#xE1;s problemas desde la visi&#xF3;n de desarrollo</h1>

<ul>
<li>Conseguir elementos en producci&#xF3;n

<ul>
<li>Dumps en producci&#xF3;n</li>
<li>C&#xF3;digo en producci&#xF3;n</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content smbullets" ref="00-intro/02_problemas/6">
<h1>Los problemas desde la visi&#xF3;n de soporte</h1>

<ul>
<li>Desarrollo no es el &#xFA;nico cliente</li>
<li>Se cumplen muchas otras tareas complejas</li>
<li>Los recursos de soporte deben configurar servicios o arquitecturas que no
definieron o desconocen 

<ul>
<li><em>API, desarrollos basados en Ruby, Erlang, NodeJS</em></li>
</ul></li>
<li>Seguridad comprometida al hostear aplicaciones propias o de terceros</li>
<li>Manejo de acceso a los servidores</li>
<li>Vencimientos de SSL</li>
</ul>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content smbullets" ref="00-intro/02_problemas/7">
<h1>Los problemas desde la visi&#xF3;n de producci&#xF3;n</h1>

<ul>
<li>Qu&#xE9; tener en cuenta para instalar nuevas aplicaciones</li>
<li>Qu&#xE9; hacer para actualizar una aplicaci&#xF3;n</li>
<li>C&#xF3;mo aplicar un parche en una base de datos grande que se encuentra en
producci&#xF3;n</li>
<li>Notificar a usuarios finales del servicio</li>
<li>P&#xE1;ginas de error ante problemas</li>
<li>Monitoreo y backup constante de los servicios</li>
<li>Vencimiento de los contratos</li>
</ul>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content subsection center" ref="00-intro/03_soluciones/1">
<h1>Las soluciones</h1>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content bullets incremental" ref="00-intro/03_soluciones/2">
<h1>Las soluciones</h1>

<p>A partir de necesidades se fueron analizando soluciones. Muchas no nos llevaron
a nada, pero nos obligaron a juntarnos de forma interdisciplinaria y pensar en
posibles soluciones</p>

<ul>
<li>As&#xED; fueron apareciendo:

<ul>
<li>Virtualizacion</li>
<li>Matriz de aplicaciones por su seguridad y criticidad</li>
<li>Configuraciones de Apache con VHosts por usuario</li>
<li>Reglas de IPtables por usuario</li>
<li>Nuevos productos: nginx, openvz, varnish</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content smbullets" ref="00-intro/03_soluciones/3">
<h1>Virtualizaci&#xF3;n</h1>

<ul>
<li><p>Nos ayud&#xF3; a:</p>

<ul>
<li>Simplificar el backup</li>
<li>Gesti&#xF3;n de equipos</li>
<li>Migrar en caliente</li>
<li>Aprovechar el espacio y recursos</li>
<li>Instalaci&#xF3;n de nuevas m&#xE1;quinas a partir de templates</li>
</ul></li>
<li><p>Nos complic&#xF3; en:</p>

<ul>
<li>Mantener las m&#xE1;quinas virtuales</li>
<li>El estado real de las virtuales</li>
<li>Sin storage no se tienen muchas funcionalidades interesantes</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content bullets" ref="00-intro/03_soluciones/4">
<h1>Matriz de aplicaciones</h1>

<p>Creimos que arrancar un relevamiento de aplicaciones por seguridad y criticidad
de los datos, podr&#xED;a ayudarnos a armar ambientes disjuntos.</p>

<p>Esta idea deriv&#xF3; en analizar herramientas para deployar aplicaciones web de
forma aislada.</p>

<ul>
<li><p>Algunas ideas:</p>

<ul>
<li>Apache modulo itk</li>
<li><a href="http://php-fpm.org/">PHP fpm</a></li>
<li>No todo es xAMP</li>
<li>Contenedores: <a href="http://openvz.org/">OpenVZ</a>, <a href="http://lxc.sourceforge.net/">Linux
Containers</a></li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content smbullets" ref="00-intro/03_soluciones/5">
<h1>Configuraciones de Apache con VHosts por usuario</h1>

<ul>
<li>Trabajamos en conjunto entre CeRT, Guarani, Desarrollo y Soporte analizando
alternativas</li>
<li>Los ambientes no eran los mismos pero todos usabamos Apache, PHP y alguna base
de datos: Mysql, Postgres o Informix</li>
<li>Se encontr&#xF3; el modulo <a href="http://mpm-itk.sesse.net/">Apache ITK</a></li>
</ul>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content smbullets" ref="00-intro/03_soluciones/6">
<h1>Configuraciones de Apache con VHosts por usuario</h1>

<ul>
<li>Se definieron procedimientos para configurar un Apache seguro y
estandar:

<ul>
<li>Errores en castellano, con un estilo similar para todas nuestra aplicaciones</li>
<li>No revelar la identidad del servidor</li>
<li>No permitir ejecuciones de scripts en algunos directorios</li>
<li>Evitar que interfieran entre aplicaciones</li>
</ul></li>
<li>Problemas?

<ul>
<li>Gestionar usuarios para cada aplicacion</li>
<li>Distintos ambientes: testing, producci&#xF3;n</li>
<li>Aplicaciones Ruby y Java</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content smbullets smaller" ref="00-intro/03_soluciones/7">
<h1>Reglas de iptables por usuario de aplicacion</h1>

<p>Ejemplo de la regla por defecto de una aplicaci&#xF3;n WEB que no use una API o
servicio:</p>

<pre class="sh_sh"><code>iptables -P OUTPUT DROP
iptables -P INPUT DROP
iptables -P FORWARD DROP
iptables -I INPUT -m state --ESTABLISHED,RELATED \
    -j ACCEPT
iptables -I INPUT -p tcp --dport 80 -j ACCEPT
iptables -I OUTPUT -m state --STATE ESTABLISHED,RELATED \
    -j ACCEPT
iptables -I OUTPUT -m owner --gid-owner webservers \
    -m state --state ESTABLISHED,RELATED -j ACCEPT</code></pre>

<ul>
<li>Problemas

<ul>
<li>Manejar qu&#xE9; aplicaci&#xF3;n se conecta con qu&#xE9; otra</li>
<li>Y al migrar una dependencia?</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content smbullets" ref="00-intro/03_soluciones/8">
<h1>Encontramos nuevos productos</h1>

<ul>
<li><a href="http://php-fpm.org/">PHP fpm</a></li>
<li><a href="http://nginx.org/">Nginx</a></li>
<li><a href="https://www.varnish-cache.org/">Varnish</a></li>
<li>Ruby:

<ul>
<li><a href="https://www.phusionpassenger.com">Apache Passenger</a></li>
<li><a href="http://unicorn.bogomips.org/">Unicorn</a></li>
<li><a href="http://puma.io/">Puma</a></li>
</ul></li>
</ul>

<p>Necesitamos expertice de nuestros equipos de trabajo en estos productos</p>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content center subsection" ref="00-intro/04_devops/1">
<h1>Devops</h1>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content bullets" ref="00-intro/04_devops/2">
<h1>Devops</h1>

<p><em>DevOps</em> es una nueva tendencia orientada a obtener una relaci&#xF3;n colaborativa de
trabajo entre las &#xE1;reas de desarrollo  y TI</p>

<ul>
<li><p>Objetivos</p>

<ul>
<li>Mejorar el tiempo de respuesta</li>
<li>Cumplir con las fases del proyecto seg&#xFA;n lo planeado</li>
<li>Exigir confiabilidad, estabilidad, resiliencia  y seguridad en el ambiente de operaciones</li>
</ul></li>
<li><p>Uno de los lemas de DevOps es</p>

<ul>
<li><em>Desarrolladores que piensen como operadores y
operadores que piensen como desarrolladores</em></li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content bullets" ref="00-intro/04_devops/3">
<h1>Devops</h1>

<p>DevOps puede verse como un m&#xE9;todo de desarrollo de software que promueve la
comunicaci&#xF3;n, colaboraci&#xF3;n e integraci&#xF3;n entre desarrolladores y
administradores de TI. </p>

<p>Su objetivo es liberar r&#xE1;pidamente productos y servicios de
software.</p>

<ul>
<li>Sus origenes:

<ul>
<li>Velocity Conference</li>
<li>Infrastructure as a code</li>
<li>Agile Infrastructure</li>
<li>Agile system administration</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content bullets" ref="00-intro/04_devops/4">
<h1>Ciclo de vida</h1>

<h2>Ciclo de vida</h2>

<p>Se define Ciclo de vida el tiempo promedio que toma desde que un nuevo
requerimiento es aprobado, se hace un requerimiento de cambio, o un error es
identificado, hasta su pase a producci&#xF3;n.</p>

<p>Organizaciones que utilizan m&#xE9;todos &#xE1;giles necesitan minimizar este ciclo de
vida y reducirlo a minutos, en algunos casos.</p>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content bullets" ref="00-intro/04_devops/5">
<h1>Versionado de contextos/ambientes</h1>

<h2>Versionado de contextos/ambientes</h2>

<p>El personal de  Operaciones debe lidiar con m&#xFA;ltiples configuraciones e
instalaci&#xF3;n de actualizaciones. Estos cambios implican una nueva <em>versi&#xF3;n</em> de
ese ambiente. La &#xFA;nica manera de realizarlo a tiempo, en forma documentada y
minimizando la posibilidad de error es a trav&#xE9;s de scripts.</p>

<p>Ante estas exigencias, surge la tendencia llamada <em>Infrastructure as a code</em>.</p>

<p>Los scripts generan nuevos entornos virtuales que deben ser versionados como el
c&#xF3;digo tradicional, administrando la configuraci&#xF3;n de acuerdo a las buenas
pr&#xE1;cticas.</p>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content subsection center" ref="00-intro/05_prods/1">
<h1>Productos que simplifican las tareas</h1>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content smbullets incremental smaller" ref="00-intro/05_prods/2">
<h1>Productos que simplifican las tareas</h1>

<ul>
<li>Virtualizaci&#xF3;n

<ul>
<li>VMWare</li>
<li>Proxmox</li>
<li>Otros que tengo ganas de analizar: <em>Openstack, Xen</em></li>
</ul></li>
<li>Infarestructure as Code 

<ul>
<li><strong>Chef</strong></li>
<li>Puppet</li>
</ul></li>
<li>Versionado de c&#xF3;digo

<ul>
<li>Subversion</li>
<li><strong>Git</strong></li>
</ul></li>
<li>Conducta

<ul>
<li>Este es el punto m&#xE1;s dificil de alcanzar</li>
<li>Nuestra sociedad <strong>no sabe</strong> respetar convenciones</li>
<li>El aporte diario e individual se vuelve fruct&#xED;fero al tiempo de aplicar
convenciones</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content subsection center" ref="01-chef-dev/01_intro/1">
<h1>Chef</h1>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content smbullets incremental small" ref="01-chef-dev/01_intro/2">
<h1>Introducci&#xF3;n</h1>

<ul>
<li>Conceptos sobre Chef</li>
<li>Fundamentos de ruby

<ul>
<li>El ambiente</li>
<li>Probando ruby</li>
<li>Breve introducci&#xF3;n al lenguaje</li>
<li>Qu&#xE9; son las gemas</li>
<li>Material de Ruby</li>
</ul></li>
<li>GIT</li>
<li>Desarrollando con chef

<ul>
<li>Recursos</li>
<li>Vagrant</li>
<li>Berkshelf</li>
<li>Ciclo de desarrollo en Chef</li>
<li>Amazon EC2</li>
<li>Material de chef</li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content subsection center" ref="01-chef-dev/02_chef_intro/1">
<h1>Conceptos sobre Chef</h1>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content smbullets" ref="01-chef-dev/02_chef_intro/2">
<h1>Conceptos sobre Chef</h1>

<ul>
<li>Chef permite modelar la evoluci&#xF3;n de nuestra infraestructura y aplicaciones como si fueran c&#xF3;digo</li>
<li>No impone restricciones</li>
<li>Permite describir y automatizar los procesos e infraestructura</li>
<li>La consecuencia es que la infraestructura se vuelve:

<ul>
<li>Versionable</li>
<li>Testeable</li>
<li>Replicable</li>
</ul></li>
<li><a href="http://www.opscode.com/customers/">&#xBF;Quienes lo usan?</a></li>
</ul>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content smbullets" ref="01-chef-dev/02_chef_intro/3">
<h1>Conceptos sobre Chef</h1>

<ul>
<li>Para lograr su objetivo se utilizan definiciones reutilizables llamadas
<strong>cookbooks</strong> y <strong>recipes</strong></li>
<li>Los recipes se programan en Ruby</li>
<li>Permiten automatizar tareas repetitivas</li>
<li>Chef aplica estas definiciones en servidores produciendo as&#xED; una
infraestructura automatizada</li>
</ul>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content smbullets" ref="01-chef-dev/02_chef_intro/4">
<h1>Cookbooks y recipes</h1>

<ul>
<li>Los cookbooks y recipes se construyen a partir de <strong>resources</strong></li>
<li>Chef provee una gran cantidad de resources</li>
<li>Adem&#xE1;s pueden escribirse los propios</li>
<li>Muchos son contribuciones de la comunidad que utiliza Chef a partir de
cookbooks p&#xFA;blicos</li>
</ul>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content center" ref="01-chef-dev/02_chef_intro/5">
<h1>Code CAN</h1>

<iframe width="560" height="315" src="http://www.youtube.com/embed/T8ijdOQj4ZA" frameborder="0"/>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content center" ref="01-chef-dev/02_chef_intro/6">
<h1>Topolog&#xED;a de Chef</h1>

<p><img src="./file/01-chef-dev/topologia-chef.png" alt="topologia"/>
</p>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content subsection center" ref="01-chef-dev/03_ruby/1">
<p><a href="http://www.ruby-lang.org/es/"><img src="./file/01-chef-dev/ruby.png" alt="Ruby"/></a>

<h1>Fundamentos de ruby</h1>
</p>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content smbullets small" ref="01-chef-dev/03_ruby/2">
<h1>Fundamentos de ruby</h1>

<ul>
<li>De origen Japon&#xE9;s</li>
<li>Lenguaje simple de leer

<ul>
<li>Simple pero potente</li>
</ul></li>
<li>Permite la definici&#xF3;n de DSL

<ul>
<li>DSL: Domain Specific Language</li>
</ul></li>
<li>Interpretado, reflexivo, orientado a objetos</li>
<li>Inspirado en:

<ul>
<li>Sintaxis: Python y Perl</li>
<li>Caracter&#xED;sticas de programaci&#xF3;n similares a Smalltalk, y en algunos aspectos a
LISP, LUA</li>
</ul></li>
<li>Hay muchas implementaciones de m&#xE1;quinas virtuales, las m&#xE1;s usadas son:

<ul>
<li><a href="http://www.ruby-lang.org/es/">MRI</a></li>
<li><a href="http://jruby.org/">jRuby</a></li>
<li><a href="http://rubini.us/">Rubinius</a></li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content execute" ref="01-chef-dev/03_ruby/3">
<h1>Ejemplo de codigo ruby</h1>

<pre class="sh_ruby"><code>1 + 2           # =&gt; 3
2 * 7           # =&gt; 14
5 / 2           # =&gt; 2
5 / 2.0         # =&gt; 2.5
1 + (2 * 3)     # =&gt; 7 </code></pre>

<p><em>Ruby siempre retorna un valor. En el caso anterior la ejecuci&#xF3;n del c&#xF3;digo
retorna 7 que es la &#xFA;ltima instrucci&#xF3;n</em></p>

<pre class="sh_ruby"><code>result = [1, 2, 3].map { |n| n*7 }</code></pre>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content smbullets" ref="01-chef-dev/03_ruby/4">
<h1>El ambiente</h1>

<p><img src="./file/01-chef-dev/ambiente.png" alt="ambiente"/>

<ul>
<li><strong>No conviene instalarlo directamente con apt-get</strong></li>
<li>Se utilizan manejadores de m&#xE1;quinas virtuales de Ruby

<ul>
<li><a href="https://rvm.io/">rvm</a></li>
<li><a href="http://rbenv.org/">rbenv</a></li>
</ul></li>
</ul>
</p>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content commandline incremental" ref="01-chef-dev/03_ruby/5">
<h1>Instalando rvm</h1>

<pre><code><code class="command">$ \curl -L https://get.rvm.io | bash -s stable</code>
<code class="result">    % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                                                 Dload  Upload   Total   Spent    Left  Speed
100   184  100   184    0     0    168      0  0:00:01  0:00:01 --:--:--   216
100 13466  100 13466    0     0   6708      0  0:00:02  0:00:02 --:--:-- 54518
Downloading RVM from wayneeseguin branch stable
    % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                                                 Dload  Upload   Total   Spent    Left  Speed
100   124  100   124    0     0    132      0 --:--:-- --:--:-- --:--:--   222
100 1067k  100 1067k    0     0   171k      0  0:00:06  0:00:06 --:--:--  222k

Installing RVM to ...
</code></code></pre>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content commandline" ref="01-chef-dev/03_ruby/6">
<h1>Verificamos la instalaci&#xF3;n de rvm</h1>

<h2>Primero debemos reiniciar sesi&#xF3;n o</h2>

<pre><code><code class="command">$ source .bash_profile</code>
</code></pre>

<h2>Verificamos que rvm est&#xE1; instalado:</h2>

<pre><code><code class="command">$ type cd</code>
<code class="result">cd: es una funci&#xF3;n
cd () 
{ 
        if builtin cd "$@"; then
                [[ -n "${rvm_current_rvmrc:-}" &amp;&amp; "$*" == "." ]] &amp;&amp; rvm_current_rvmrc=""
|| true;
                __rvm_cd_functions_set;
                return 0;
        else
                return $?;
        fi
}
</code></code></pre>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content commandline" ref="01-chef-dev/03_ruby/7">
<h1>Instalamos ruby 1.9.3 con rvm</h1>

<h2>Requiere que el usuario sea sudoer</h2>

<pre><code><code class="command">$ rvm install 1.9.3</code>
<code class="result">Searching for binary rubies, this might take some time.
ruby-1.9.3-p429 - #configure
ruby-1.9.3-p429 - #download
ruby-1.9.3-p429 - #validate archive
ruby-1.9.3-p429 - #extract
ruby-1.9.3-p429 - #validate binary
ruby-1.9.3-p429 - #setup
Saving wrappers to '/home/.../.rvm/wrappers/ruby-1.9.3-p429'........
ruby-1.9.3-p429 - #importing default gemsets, this may take
time.......................

</code><code class="command">$ rvm list</code>
<code class="result">rvm rubies

=* ruby-1.9.3-p429 [ x86_64 ]

</code><code class="command"># =&gt; - current</code>
<code class="command"># =* - current &amp;&amp; default</code>
<code class="command"># * - default</code>
</code></pre>

<p class="notes">Si no queremos que rvm maneje el manejador de paquetes, podemos deshabilitarlo con: <code>$ rvm autolibs disable</code></p>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content commandline" ref="01-chef-dev/03_ruby/8">
<h1>Rubies disponibles</h1>

<pre><code><code class="command">$ rvm list known</code>
<code class="command"># MRI Rubies</code>
<code class="result">[ruby-]1.8.6[-p420]
[ruby-]1.8.7[-p371]
[ruby-]1.9.1[-p431]
[ruby-]1.9.2[-p320]
[ruby-]1.9.3-p125
[ruby-]1.9.3-p194
[ruby-]1.9.3-p286
[ruby-]1.9.3-p327
[ruby-]1.9.3-p362
[ruby-]1.9.3-p374
[ruby-]1.9.3-p385
[ruby-]1.9.3-p392
[ruby-]1.9.3[-p429]
[ruby-]1.9.3-head
[ruby-]2.0.0-rc1
[ruby-]2.0.0-rc2
[ruby-]2.0.0-p0
[ruby-]2.0.0[-p195]
ruby-head
</code></code></pre>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content commandline" ref="01-chef-dev/03_ruby/9">
<h1>Probando Ruby</h1>

<h2>Desde la consola</h2>

<pre><code><code class="command">$ ruby -e 'user=ENV["USER"]; print "Hola #{user}!!\n"'</code>
</code></pre>

<h2>En forma interactiva</h2>

<pre><code><code class="command">$ irb</code>
<code class="result">1.9.3-p429 :001 &gt; 2+2
 =&gt; 4 
</code></code></pre>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content execute" ref="01-chef-dev/03_ruby/10">
<h1>Un poco de Ruby</h1>

<h2>Comentarios</h2>

<pre class="sh_ruby"><code>#Este es un comentario</code></pre>

<h2>Asignaci&#xF3;n</h2>

<pre class="sh_ruby"><code>x = 1</code></pre>

<h2>Strings</h2>

<pre class="sh_ruby"><code>"con comillas dobles"
'con comillas simples'
"El resultado de 2+2 = #{2+2}"</code></pre>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content execute small" ref="01-chef-dev/03_ruby/11">
<h1>Un poco de Ruby</h1>

<h2>Booleans</h2>

<p>Ruby tiene una visi&#xF3;n simplista de la verdad: <em>todo lo que no sea <code>nil</code> o la constante <code>false</code> es <code>verdadero</code></em> </p>

<pre class="sh_ruby"><code>true            # =&gt; true
false           # =&gt; false
nil             # =&gt; nil
1 == 1          # =&gt; true 
1 == true       # =&gt; false 
nil == false    # =&gt; false </code></pre>

<h2>Negacion</h2>

<pre class="sh_ruby"><code>!true           # =&gt; false
!false          # =&gt; true
!nil            # =&gt; true
1 != 2          # =&gt; true 
1 != 1          # =&gt; false</code></pre>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content execute" ref="01-chef-dev/03_ruby/12">
<h1>Un poco de Ruby</h1>

<h2>S&#xED;mbolos</h2>

<p>Son constantes, que se precedent con el s&#xED;mbolo <code>:</code> que ocupan un &#xFA;nico espacio de memoria:</p>

<pre class="sh_ruby"><code>:mi_simbolo.object_id  # =&gt; 461608
"mi_string".object_id  # =&gt; 9986260
"mi_string".object_id  # =&gt; 9996160
:mi_simbolo.object_id  # =&gt; 461608</code></pre>

<p>Los s&#xED;mbolos son usados generalmente para acceder a arreglos asociativos, por
ejemplo:</p>

<pre class="sh_ruby"><code>default[:apache][:ports]</code></pre>

<p class="notes">Usar simbolos para mejorar el uso de memoria puede ser un memory leak en algunos casos</p>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content execute small" ref="01-chef-dev/03_ruby/13">
<h1>Un poco de Ruby</h1>

<h2>Listas con arreglos</h2>

<pre class="sh_ruby"><code>x = ["a", "b", "c"] # =&gt; ["a", "b", "c"]
x[0]                # =&gt; "a" 
x.first             # =&gt; "a" 
x.last              # =&gt; "c"
x + ["d"]           # =&gt; ["a", "b", "c", "d"]
x                   # =&gt; ["a", "b", "c"] 
x = x + ["d"]       # =&gt; ["a", "b", "c", "d"]
x                   # =&gt; ["a", "b", "c", "d"]
x += ["e"]          # =&gt; ["a", "b", "c", "d","e"]
x                   # =&gt; ["a", "b", "c", "d","e"]</code></pre>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content execute small" ref="01-chef-dev/03_ruby/14">
<h1>Un poco de Ruby</h1>

<h2>Operando con las listas</h2>

<pre class="sh_ruby"><code>x = [1, 2, 3, 4]
x.all?                     # =&gt; true
x.all? {|x| x % 2 == 0 }   # =&gt; false
x.any? {|x| x % 2 == 0 }   # =&gt; true
x.detect {|x| x % 2 == 0 } # =&gt; 2
x.each {|x| p x }          # =&gt; Imprime cada elem
x.select {|x| x % 2 }      # =&gt; [2, 4]
x.collect {|x| x*2 }       # =&gt; [2, 4, 6, 8]
x.map                      # Idem collect 
x.first                    # =&gt; 1
x.last                     # =&gt; 4
x[0]                       # =&gt; 1</code></pre>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content smbullets" ref="01-chef-dev/03_ruby/15">
<h1>Un poco de Ruby</h1>

<h2>Bloques</h2>

<ul>
<li>En el ejemplo anterior usabamos bloques con <code>{...}</code></li>
<li>Un bloque puede tener par&#xE1;metros <code>{ |x| ...}</code></li>
<li>Los bloques pueden escribirse en m&#xE1;s de una l&#xED;nea usando <code>do... end</code></li>
</ul>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content execute" ref="01-chef-dev/03_ruby/16">
<h1>Un poco de Ruby</h1>

<h2>Bloques en m&#xE1;s de una l&#xED;nea</h2>

<pre class="sh_ruby"><code>array = [1, 2, 3, 4]

array.collect! do |n|
    n ** 2
end

array</code></pre>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content execute smaller" ref="01-chef-dev/03_ruby/17">
<h1>Un poco de Ruby</h1>

<h2>Hashes</h2>

<p>Los Hashes son arreglos asociativos y por su estructura semejante a un registro,
son muy utilizados</p>

<pre class="sh_ruby"><code>grades = { 
  "Jane Doe" =&gt; 10, 
  "Jim Doe" =&gt; 6 
}
grades["Jane Doe"]                # =&gt; 10</code></pre>

<h3>La sintaxis cambi&#xF3; a partir de la versi&#xF3;n 1.9</h3>

<pre class="sh_ruby"><code>options = {                       # =&gt; Sintaxis &lt;= 1.8
  :opt_1 =&gt; 1, 
  :opt_2 =&gt; 2
}
options = { opt_1: 1, opt_2: 2}   # =&gt; Sintaxis &gt; 1.8</code></pre>

<blockquote>
<p>Si un Hash utiliza strings para sus claves, los s&#xED;mbolos no podr&#xE1;n ser utilizados de forma indistinta. Para este tipo de situaciones se utilizan <a href="https://github.com/mbleigh/mash">Mash</a></p>
</blockquote>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content execute smaller" ref="01-chef-dev/03_ruby/18">
<h1>Un poco de Ruby</h1>

<h2>El <code>if</code></h2>

<p>En ruby, toda expresi&#xF3;n retorna algo. Por tanto:</p>

<pre class="sh_ruby"><code>a = if true
    3
end</code></pre>

<p>Se puede escribir en una &#xFA;nica l&#xED;nea:</p>

<pre class="sh_ruby"><code>a = 1
a = 7 if a &lt; 2</code></pre>

<p>Existen <code>else</code> y <code>elsif</code>:</p>

<pre class="sh_ruby"><code>a = 10
if a &lt; 2
    a = 3
elsif a == 2
    a = 4
else
    a = 5
end</code></pre>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content execute" ref="01-chef-dev/03_ruby/19">
<h1>Un poco de Ruby</h1>

<h2>El <code>unless</code></h2>

<p>Se utiliza para evitar <code>if ! &lt;expresion&gt;</code></p>

<pre class="sh_ruby"><code>a = 5
unless a == 4
    a = 7
end</code></pre>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content execute smaller" ref="01-chef-dev/03_ruby/20">
<h1>Un poco de Ruby</h1>

<h2>M&#xE9;todos</h2>

<p>Los m&#xE9;todos se crean con la palabra <code>def</code></p>

<pre class="sh_ruby"><code>def do_something_useless( first_argument, second_argument)
    "You gave me #{first_argument} and #{second_argument}"
end
do_something_useless( "apple", "banana")</code></pre>

<p>Y se invoca con o sin par&#xE9;ntesis</p>

<pre class="sh_ruby"><code>do_something_useless( "apple", "banana")
# =&gt; "You gave me apple and banana"
do_something_useless 1, 2
# =&gt; "You gave me 1 and 2"</code></pre>

<blockquote>
<p>No usar par&#xE9;ntesis puede traer problemas por las reglas de precedencia</p>
</blockquote>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content smbullets" ref="01-chef-dev/03_ruby/21">
<h1>Un poco de Ruby</h1>

<h2>Clases y Modulos</h2>

<ul>
<li><p>No son necesarios en chef porque provee un DSL. Podr&#xED;amos usar clases si
deseamos, pero el modelo de objetos necesario para Chef no amerita
complicaciones. Tal ve en *</p></li>
<li><p>Las clases son el concepto conocido</p></li>
<li><p>Los m&#xF3;dulos permiten:</p>

<ul>
<li>Definir <code>namespaces</code> y sobrecargar clases</li>
<li>Permiten implementar <code>mixins</code></li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content smbullets" ref="01-chef-dev/03_ruby/22">
<h1>Qu&#xE9; son las gemas</h1>

<ul>
<li>Las gemas son librer&#xED;as empaquetadas que se instalan desde la red e instalan
en mi ambiente</li>
<li>Hist&#xF3;ricamente se manejaban con el comando <code>gem</code></li>
<li>Luego <code>rvm</code> introdujo el concepto de <code>gemsets</code></li>
<li>Actualmente las gemas se manejan con <a href="http://gembundler.com/">bundler</a></li>
</ul>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content commandline" ref="01-chef-dev/03_ruby/23">
<h1>Uso de bundler</h1>

<h2>Instalando bundler</h2>

<pre><code><code class="command">$ gem install bundler</code>
</code></pre>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content commandline" ref="01-chef-dev/03_ruby/24">
<h1>Uso de bundler</h1>

<h2>Usando bundler</h2>

<p>Crear un nuevo directorio:</p>

<pre><code><code class="command">$ mkdir mi_proyecto</code>
</code></pre>

<p>Inicializamos el nuevo directorio</p>

<pre><code><code class="command">$ bundle init</code>
<code class="result">Writing new Gemfile to /xxx/Gemfile
</code></code></pre>

<p>Esto crear&#xE1; un archivo llamado Gemfile, donde podemos agregar dependencias que
utilizaremos en este proyecto, considerando incluso ambientes: <em>desarrollo</em>,
<em>producci&#xF3;n</em></p>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content commandline" ref="01-chef-dev/03_ruby/25">
<h1>Uso de bundler</h1>

<p>Editamos el archivo <code>Gemfile</code> y agregamos las gemas necesarios, en este ejemplo
<strong>rainbow</strong></p>

<pre class="sh_ruby"><code><code class="command"># A sample Gemfile</code>
<code class="result">source "https://rubygems.org"

</code><code class="command"># gem "rails"</code>
<code class="result">gem "rainbow"</code></code></pre>

<p>Actualizamos el proyecto:</p>

<pre><code><code class="command">$ bundle  # o bundle install o bundle update</code>
</code></pre>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content commandline" ref="01-chef-dev/03_ruby/26">
<h1>Uso de bundler</h1>

<h2>Usando la Gema</h2>

<p>Y ahora podemos crear un script ruby:</p>

<pre class="sh_ruby"><code><code class="command"># require 'rainbow'</code>
<code class="result">
puts "this is red".foreground(:red) 
puts "this on yellow bg".background(:yellow)
puts "even bright underlined!".underline.bright</code></code></pre>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content smbullets" ref="01-chef-dev/03_ruby/27">
<h1>Material de Ruby</h1>

<ul>
<li><a href="http://tryruby.org/">Try Ruby</a></li>
<li><a href="http://pragprog.com/book/ruby/programming-ruby">Programming Ruby (2nd
edition)</a></li>
<li><a href="http://www.ruby-doc.org/core-2.0/">API Ruby</a></li>
</ul>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content subsection center" ref="01-chef-dev/04_git/1">
<p><a href="http://git-scm.com/"><img src="./file/01-chef-dev/git.png" alt="GIT"/></a>

<h1>Un poco de GIT</h1>
</p>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content smbullets small incremental" ref="01-chef-dev/04_git/2">
<h1>Introducci&#xF3;n</h1>

<ul>
<li>Es un <strong>SCM</strong> <em>(Source Code Management)</em></li>
<li>Si usabas SVN, hay que comprarse:
<img src="./file/01-chef-dev/MIB.png" alt="MIB Memory eraser"/>
</li>
</ul>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content fullpage" ref="01-chef-dev/04_git/3">
<p><img src="./file/01-chef-dev/git-workflow.png" alt="Git workflow"/>
</p>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content commandline incremental" ref="01-chef-dev/04_git/4">
<h1>Comandos b&#xE1;sicos</h1>

<pre><code><code class="command">$ mkdir mi_proyecto</code>
<code class="command">$ cd mi_proyecto</code>
<code class="command">$ git init </code>
<code class="result">Initialized empty Git repository in /xxx/mi_proyecto/.git/
</code><code class="command">$ ls -a</code>
<code class="result">.  ..  .git
</code><code class="command">$ echo Hola &gt; README.md</code>
<code class="command">$ git status</code>
<code class="result"> # On branch master
 #
 # Initial commit
 #
 # Untracked files:
 #   (use "git add &lt;file&gt;..." to include in what will be committed)
 #
 #  README.md
 nothing added to commit but untracked files present (use "git add" to track)
</code></code></pre>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content commandline incremental" ref="01-chef-dev/04_git/5">
<h1>Comandos b&#xE1;sicos</h1>

<h3>Agregando al Staging Area y luego al repo local</h3>

<pre><code><code class="command">$ git add README</code>
<code class="command">$ git status</code>
<code class="result"> # On branch master
 #
 # Initial commit
 #
 # Changes to be committed:
 #   (use "git rm --cached &lt;file&gt;..." to unstage)
 #
 #  new file:   README.md
 #
</code><code class="command">$ git commit -m "Importacion inicial"</code>
<code class="result">[master (root-commit) 3667c85] Importacion inicial
 1 file changed, 1 insertion(+)
 create mode 100644 README.md
</code></code></pre>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content commandline incremental" ref="01-chef-dev/04_git/6">
<h1>Comandos b&#xE1;sicos</h1>

<h3>Agregando repos remotos</h3>

<pre><code><code class="command">$ git remote -v</code>
<code class="command">$ git remote add origin URL</code>
<code class="command">$ git remote -v</code>
<code class="result">origin URL (fetch)
origin URL (push)
</code><code class="command">$ git push -u &lt;URL de remoto&gt; &lt;branch&gt;</code>
</code></pre>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content smbullets" ref="01-chef-dev/04_git/7">
<h1>Algunos conceptos</h1>

<ul>
<li>El <strong>branch</strong> por defecto es <strong>master</strong></li>
<li>A la URL remota donde hacemos push se lo denomina <strong>upstream</strong> </li>
</ul>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content smbullets" ref="01-chef-dev/04_git/8">
<h1>Github</h1>

<p><a href="https://github.com"><img src="./file/01-chef-dev/github.png" alt="Github"/></a>
</p>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content smbullets small" ref="01-chef-dev/04_git/9">
<h1>Github</h1>

<ul>
<li>Es una red social de c&#xF3;digo</li>
<li>Utiliza GIT</li>
<li>Cada usuario es due&#xF1;o de sus repositorios</li>
<li>No es posible hacer push en repositorio de otros usuarios

<ul>
<li>Intorduce el concepto de <strong>fork</strong></li>
<li>Y el de <strong>pull requests</strong></li>
</ul></li>
<li>Permite la colaboraci&#xF3;n mucho m&#xE1;s &#xE1;gil:

<ul>
<li>Se comentan los patch a proyectos</li>
<li>Se aceptan o no por el due&#xF1;o</li>
<li>Si no lo aceptan, uso mi fork</li>
</ul></li>
<li>Pueden definirse organizaciones que agrupan usuarios y en este caso es posible
compartir repositorios

<ul>
<li><a href="https://github.com/chrodriguez">Mi espacio en Github</a></li>
<li><a href="https://github.com/Desarrollo-CeSPI">El espacio de CeSPI en Github</a></li>
</ul></li>
</ul>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content smbullets" ref="01-chef-dev/04_git/10">
<h1>Material de GIT</h1>

<ul>
<li><a href="http://try.github.io/">Try GIT</a></li>
<li><a href="http://git-scm.com/">Libro de GIT</a></li>
<li><a href="http://pcottle.github.io/learnGitBranching/">Git branching</a></li>
</ul>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content subsection center" ref="01-chef-dev/05_desarrollando_con_chef/1">
<h1>Desarrollando con Chef</h1>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content smbullets" ref="01-chef-dev/05_desarrollando_con_chef/2">
<h1>Desarrollando con Chef</h1>

<ul>
<li>Se respeta una filosof&#xED;a muy instaurada en la comunidad Ruby

<ul>
<li><strong>Convention over configuration</strong></li>
</ul></li>
<li>Todos los cookbooks tienen la misma estructura</li>
</ul>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content commandline" ref="01-chef-dev/05_desarrollando_con_chef/3">
<h1>Estructura de un cookbook</h1>

<pre><code><code class="command">$ tree -d mis_cookbooks/mi_cookbook</code>
<code class="result"> &#x251C;&#x2500;&#x2500; attributes
 &#x251C;&#x2500;&#x2500; definitions
 &#x251C;&#x2500;&#x2500; files
 &#x251C;&#x2500;&#x2500; libraries
 &#x251C;&#x2500;&#x2500; providers
 &#x251C;&#x2500;&#x2500; recipes
 &#x251C;&#x2500;&#x2500; resources
 &#x2514;&#x2500;&#x2500; templates
</code></code></pre>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content smbullets small" ref="01-chef-dev/05_desarrollando_con_chef/4">
<h1>Estructura de un cookbook</h1>

<ul>
<li>Los <strong>recipes</strong> se guardan en el directorio <code>recipes</code>. Y su nombre es importante:

<ul>
<li><strong>recipe[ntp::foo]:</strong> <code>mis_cookbooks/ntp/recipes/foo.rb</code></li>
<li><strong>recipe[ntp]:</strong> <code>mis_cookbooks/ntp/recipes/default.rb</code></li>
</ul></li>
<li>El nombre de un recipe debe especificar el nombre del cookbook definendo as&#xED; un <strong>namespace</strong></li>
</ul>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content commandline incremental" ref="01-chef-dev/05_desarrollando_con_chef/5">
<h1>Mi primer recipe</h1>

<p>Creamos el directorio para el <code>cookbook</code> y <code>recipe</code></p>

<pre><code><code class="command">$ mkdir -p prueba_chef/cookbooks/test/recipes</code>
</code></pre>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content small" ref="01-chef-dev/05_desarrollando_con_chef/6">
<h1>Mi primer recipe</h1>

<p>Creamos el archivo <code>prueba_chef/cookbooks/test/recipes/default.rb</code> con el siguiente contenido:</p>

<pre class="sh_ruby"><code>user "ejemplo" do
  home '/home/ejemplo'
  shell '/bin/bash'
  password 'STHx70ea82L.Yw1eAha15.'
  # calculada con: 
  #   openssl passwd -1 "pass_de_ejemplo"
end</code></pre>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content commandline incremental smaller" ref="01-chef-dev/05_desarrollando_con_chef/7">
<h1>Lo probamos usando Vagrant</h1>

<p>Ubicados dentro del directorio raiz <code>prueba_chef/</code> corremos</p>

<pre><code><code class="command">$ vagrant init ubuntu-1204 \
     http://vagrantbox.desarrollo.cespi.unlp.edu.ar/pub/ubuntu-12.04.2-cespi-amd64.box</code>
<code class="result">A `Vagrantfile` has been placed in this directory. You are now
ready to `vagrant up` your first virtual environment! Please read
the comments in the Vagrantfile as well as documentation on
`vagrantup.com` for more information on using Vagrant.
</code></code></pre>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content smaller" ref="01-chef-dev/05_desarrollando_con_chef/8">
<h1>Lo probamos usando Vagrant</h1>

<h2>Editamos el archivo generado</h2>

<p>El comando vagrant init cre&#xF3; un archivo a partir de un template que llam&#xF3; <code>Vagrantfile</code>. Debemos indicar qu&#xE9; IP darle a nuestra m&#xE1;quina virtual. Utilizaremos <code>33.33.33.100</code></p>

<pre class="sh_ruby"><code>Vagrant.configure("2") do |config|
    config.vm.box = "opscode-ubuntu-1204"
    config.vm.box_url = "http://vagra..."
    config.vm.network :private_network, ip: "33.33.33.100"
end</code></pre>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content commandline incremental" ref="01-chef-dev/05_desarrollando_con_chef/9">
<h1>Lo probamos usando Vagrant</h1>

<p>Ahora podemos iniciar la m&#xE1;quina con vagrant</p>

<pre><code><code class="command">$ vagrant up</code>
<code class="result">Bringing machine 'default' up with 'virtualbox' provider...
[default] Box 'opscode-ubuntu-1204' was not found. Fetching box from 
specified URL for the provider 'virtualbox'. Note that if the URL does not 
have a box for this provider, you should interrupt Vagrant now and add
the box yourself. Otherwise Vagrant will attempt to download the
full box prior to discovering this error.
Downloading or copying the box...
Extracting box...te: 4563k/s, Estimated time remaining: 0:00:01)
Successfully added box 'opscode-ubuntu-1204' with provider 'virtualbox'!
[default] Importing base box 'opscode-ubuntu-1204'...
[default] Matching MAC address for NAT networking...
[default] Setting the name of the VM...
[default] Clearing any previously set forwarded ports...
[default] Creating shared folders metadata...
[default] Clearing any previously set network interfaces...
[default] Preparing network interfaces based on configuration...
[default] Forwarding ports...
[default] -- 22 =&gt; 2222 (adapter 1)
[default] Booting VM...
[default] Waiting for VM to boot. This can take a few minutes.
[default] VM booted and ready for use!
[default] Configuring and enabling network interfaces...
[default] Mounting shared folders...
[default] -- /vagrant
</code></code></pre>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content commandline incremental" ref="01-chef-dev/05_desarrollando_con_chef/10">
<h1>Lo probamos usando Vagrant</h1>

<p>Nos conectamos a la consola de la m&#xE1;quina creada y verificamos los usuarios
creados:</p>

<pre><code><code class="command">$ vagrant ssh</code>
<code class="result">Welcome to Ubuntu 12.04.2 LTS (GNU/Linux 3.5.0-23-generic x86_64)

 * Documentation:  https://help.ubuntu.com/
Last login: Thu Jun  6 16:06:44 2013 from 10.0.2.2
vagrant@ubuntu-12:~$ getent passwd 
</code></code></pre>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content smaller" ref="01-chef-dev/05_desarrollando_con_chef/11">
<h1>Lo probamos usando Vagrant</h1>

<h2>Probemos la receta</h2>

<p>Tenemos que editar el archivo Vagrantfile indicando que queremos aprovisionarlo
con <strong>chef</strong>. El archivo deber&#xE1; quedar:</p>

<pre class="sh_ruby"><code>Vagrant.configure("2") do |config|
  config.vm.box = "opscode-ubuntu-1204"
  config.vm.box_url = "http://vagra..."
  config.vm.network :private_network, ip: "33.33.33.100"
  config.vm.provision :chef_solo do |chef|
    chef.cookbooks_path = "./cookbooks"
    chef.add_recipe "test"
  end
end</code></pre>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content smaller" ref="01-chef-dev/05_desarrollando_con_chef/12">
<h1>Lo probamos usando Vagrant</h1>

<h2>Probemos la receta</h2>

<p>Una vez editado el Vagrantfile, reiniciamos vagrant y observamos la salida.</p>

<pre><code>$ vagrant reload
[default] Attempting graceful shutdown of VM...
....
....
[default] -- /vagrant
[default] -- /tmp/vagrant-chef-1/chef-solo-1/cookbooks
[default] Running provisioner: chef_solo...
Generating chef JSON and uploading...
Running chef-solo...
stdin: is not a tty
[2013-06-06T17:06:24+00:00] INFO: *** Chef 11.4.4 ***
[2013-06-06T17:06:27+00:00] INFO: Setting the run_list to
 ["recipe[test]"] from JSON
[2013-06-06T17:06:27+00:00] INFO: Run List is [recipe[test]]
[2013-06-06T17:06:27+00:00] INFO: Run List expands to [test]
[2013-06-06T17:06:27+00:00] INFO: Starting Chef Run for
ubuntu-12.04.2-cespi-amd64
[2013-06-06T17:06:27+00:00] INFO: Running start handlers
[2013-06-06T17:06:27+00:00] INFO: Start handlers complete.
...
...
</code></pre>
</div>
</div><div class="slide" data-transition="scrollVert"><div class="content center subsection" ref="02-chef-prod/01-intro">
<h1>TODO</h1>

<p class="notes">https://github.com/jonlives/knife-spork</p>
</div>
</div></div>
<div id="pauseScreen">
  
</div>

</body>
</html>
